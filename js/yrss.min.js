/* YRSS 1.1.7 */
/* Copyright (c) 2018 Mark Hillard - MIT License */

!function(d){"use strict";d.fn.yrss=function(a,n,o){return n=d.extend({ssl:!1,limit:10,reverse:!1,cache:!0,maxage:3600,showerror:!0,errormsg:"",tags:!1,date:!0,dateformat:"default",titletag:"h4",content:!0,image:!1,snippet:!0,snippetlimit:120,linktarget:"_self",logging:!1},n),this.each(function(e,i){var t="";if(n.ssl&&(t="s"),d(i).hasClass("yrss")||d(i).addClass("yrss"),!a)return!1;var r="http"+t+"://query.yahooapis.com/v1/public/yql?q="+encodeURIComponent('select * from feed where url="'+a+'"');n.limit&&(r+=" limit "+n.limit),n.reverse&&(r+=" | reverse()"),n.cache&&(r+="&_maxage="+n.maxage),r+="&format=json",d.getJSON(r,function(e,t,r){if("success"===t)s(i,e,n),d.isFunction(o)&&o.call(this,d(i));else if("error"===t||"parsererror"===t){if(!n.showerror)return!1;var a;a=""!==n.errormsg?n.errormsg:r,d(i).html('<div class="rss-error"><p>'+a+"</p></div>")}})})};var s=function(e,t,l){var c=t.query.results.item;if(d.isArray(c)||(c=[c]),l.logging&&(console.log("Object Data:"),console.log(t),console.log("Entry Array:"),console.log(c)),!c)return!1;var r,g="";d.each(c,function(e){var t,r,a,i=c[e];if(i.category){if(d.isArray(i.category))t=Object.keys(i.category).map(function(e){return""!==i.category[e].domain?i.category[e].domain+":"+i.category[e].content:i.category[e].content});else if("object"===d.type(i.category)){var n=i.category.domain,o=i.category.content;t=""!==i.category.domain?n+":"+o:o}else t=i.category;t=t.toString().toLowerCase().replace(/ /g,"-").replace(/,/g," ")}if(i.pubDate){var s=new Date(i.pubDate);if("default"===l.dateformat)r=(s.getMonth()+1).toString()+"/"+s.getDate().toString()+"/"+s.getFullYear();else if("spellmonth"===l.dateformat){r=["January","February","March","April","May","June","July","August","September","October","November","December"][s.getMonth()]+" "+s.getDate().toString()+", "+s.getFullYear()}else"localedate"===l.dateformat?r=s.toLocaleDateString():"localedatetime"===l.dateformat&&(r=s.toLocaleDateString()+" "+s.toLocaleTimeString())}(g+='<div class="entry-wrapper"',l.tags&&i.category&&(g+='data-tag="'+t+'"'),g+='><div class="entry-title"><'+l.titletag+'><a href="'+i.link+'">'+i.title+"</a></"+l.titletag+"></div>",l.date&&r&&(g+='<div class="entry-date">'+r+"</div>"),l.content)&&(a=i.description?d.trim(i.description):d.trim(i.encoded),g+='<div class="entry-content">'+a+"</div>");g+="</div>"}),r=d(g),l.content&&d.each(r,function(){if(l.image){var e=d(this).find("img").first();0!==e.length?(d(this).prepend('<div class="entry-image">'),d(this).find(".entry-image").append(e).nextAll().wrapAll('<div class="entry-text"></div>')):d(this).children().wrapAll('<div class="entry-text"></div>')}else d(this).find("img").remove();if(l.snippet){var t=d(this).find(".entry-content"),r=d(t).text().length;t.text(function(e,t){return 0===r?"":0!==r&&r<=l.snippetlimit?t:t.substring(0,l.snippetlimit)+" ..."})}}),d(e).append(r),d("a",e).attr("target",l.linktarget)}}(jQuery);
